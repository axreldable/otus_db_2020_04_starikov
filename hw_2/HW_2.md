# HW_2

[Mysql create tables scripts](https://github.com/axreldable/otus_db_2020_04_starikov/blob/master/hw_2/create_tables_mysql.sql)
[Workbench schema](https://github.com/axreldable/otus_db_2020_04_starikov/blob/master/hw_2/db_schema.mwb)

### Описание бизнес задачи
База данных интернет магазина, которая содержит:
- информацию о клиентах (customers)
- информацию об адресах пользователей (addresses)
    - addresses используется как информация о пользователе - его адреса (многие ко многим)
    - addresses денормализована для удобства использования, при таком подходе может возникать неконсистентность данных. 
    Например, в таблице имеется возможность задать адресс с городом, который находится за пределами страны и тд. 
    Консистентность контролируется на клиенте.
    - при этом в адресах: в странах и регионах находятся конкретные города, в городе находятся конкретные улицы, 
    на улице находятся конкретные дома, индекс зависит от города, улицы и номера дома.
    
- информацию о заказах клиентов (orders)
    - есть ссылки и на клиента и на адрес, т.к. клиент может сделать заказ на чужой адрес
    - реадизован лог изменения статуса заказа (собирается клиентом, подтвержден менеджером, собирается на складе, 
    готов к отправлению, доставка, выполнен, клиент отказался, прибыл на склад после отказа и т.д). 
    Лог может использоваться для отслеживания статуса заказа и для последующей аналитики. 
    Время исменения статуса фиксируется.
- информацию о заказах товарах (products)
    - связь с заказами - многие ко многим
    - имеются поставщики (suppliers) - многие ко многим
    - имеются производители (vendors) - многие ко многим
- информацию о стоимости товаров (prices)
    - имеется лог изменений цены. Отдельная таблица статусов не реализована - он один изменение цены. 
    Последняя цена актуальна для товара. Стоимость заказа рассчитывается как сумма цен продуктов. 
    Изменение цены на продукт влияетет на все заказы, т.е. различная цена для различных клиентов не реализована.
- информацию о категории товаров (categories)
    - поддержана иерархия категорий
- информацию о параметрах категорий и товаров
    - поддерживаются типы - int, float, text, varchar
    

### Рекомендации к использованию репликации
- реализуется путем копирования журнала изменений с последующим накатом на реплику

### Рекомендации к резервному копированию
- использовать инкрементальный бэкап: полный дамп базы 1 раз в неделю, бэкап изменений - 1 раз в сутки.
